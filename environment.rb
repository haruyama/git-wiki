require 'rubygems'
require 'bundler/setup'

require 'grit'
require 'bluecloth'
require 'rubypants'

require './extensions'
require './page'


REPO_LOCATIONS = ["#{ENV['HOME']}/wiki", "#{ENV['HOME']}/.wiki"]

def is_repo?(location)
  File.exists?(location) && File.directory?(location)
end

def find_repo(locations = REPO_LOCATIONS)
  locations.detect do |location|
    is_repo?(location)
  end
end

def create_repo(location = REPO_LOCATIONS.first)
  puts "Initializing repository in #{location}..."
  Grit::Repo.new(location)
  location
end

def find_or_create_repo
  find_repo || create_repo
end

GIT_REPO = find_or_create_repo
HOMEPAGE = 'home'

$repo = Grit::Repo.new(GIT_REPO)

